# Kubernetes Terway (Aliyun) 全栈进阶培训 (从入门到专家)

> **适用版本**: 阿里云 ACK v1.26 - v1.32 | **文档类型**: 专家级技术实战指南
> **目标受众**: 阿里云开发者、网络架构师、SRE
> **核心原则**: 理解云原生网络架构、掌握高性能 ENI 策略

---

## 🔰 第一阶段：快速入门与核心概念

### 1.1 什么是 Terway？
*   **定义**: 阿里云容器服务 ACK 自研的网络插件 (CNI)。
*   **核心优势**: 将 Pod 直接接入阿里云 VPC 网络。Pod 的 IP 就是 VPC 的内网 IP，可以直接被外部通过内网访问（视配置而定）。

### 1.2 三种核心模式 (简单版)
1.  **VPC 路由**: 性能普通，适合简单场景。
2.  **ENI 共享 (Secondary IP)**: 性能好，最常用。
3.  **ENI 独占 (Exclusive)**: 性能极高，Pod 独霸一张网卡。

---

## 📘 第二阶段：核心架构与深度原理 (Deep Dive)

### 2.1 架构设计
*   **API 联动**: 自动调用阿里云 OpenAPI 申请和绑定弹性网卡 (ENI)。
*   **性能基准**: 几乎等同于物理机网络的性能损耗（零损耗趋势）。

---

## ⚡ 第三阶段：生产部署与极致优化

### 3.1 资源规划 (SRE 核心)
*   **VSwitch IP 规划**: 必须预留足够的 IP 地址段给 Pod。
*   **网卡配额**: ECS 规格决定了能挂载的最大网卡数。

### 3.2 监控与自愈
*   `terway_alloc_ip_duration_ms`: 申请 IP 的速度，反映了 OpenAPI 的响应情况。

---

## 🛠️ 第四阶段：排障与 SRE 运维

### 4.1 典型排障
*   **IP 耗尽**: VSwitch 没 IP 了。
*   **OpenAPI Quota**: 阿里云接口限流。

### 🏆 SRE 运维红线
*   *红线 1: 严禁在 IP 资源不足的情况下扩容集群。*
*   *红线 2: 高并发业务必须开启网卡多队列。*
*   *红线 3: 生产环境建议开启 ENI 独占模式给核心数据库/网关。*
